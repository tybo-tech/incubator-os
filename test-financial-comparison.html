<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Comparison Data Test</title>
    <style>
        body { font-family: monospace; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .section { background: white; margin: 20px 0; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .data-block { background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 15px; margin: 10px 0; white-space: pre-wrap; }
        .highlight { background: #fff3cd; padding: 2px 4px; border-radius: 3px; }
        .error { color: #dc3545; }
        .success { color: #28a745; }
        .info { color: #007bff; }
        h2 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 8px; }
        h3 { color: #666; margin-top: 25px; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .chart-preview { background: #e9ecef; padding: 20px; border-radius: 4px; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Financial Year Comparison Data Analysis</h1>

        <div class="section">
            <h2>ğŸ“Š Your Sample Data</h2>
            <p>Based on your provided raw database records:</p>
            <div class="data-block">
<span class="info">Financial Year 1 (ID: 1):</span>
- Account ID: 26
- m1: 2000, m2: 2000, m3: 1000, m4: 2000, m5: 8000, m6: 100000, m7: 100, m8-m12: 0
- Total: 115,100

<span class="info">Financial Year 5 (ID: 5):</span>
- Account ID: 26
- m1: 50000, m2-m12: 0
- Total: 50,000
            </div>
        </div>

        <div class="section">
            <h2>ğŸ”„ Expected Data Transformation</h2>
            <h3>Step 1: Raw Database â†’ YearGroup Interface</h3>
            <div class="data-block">
YearGroup[] = [
  {
    id: 1,
    name: "FY 2024/2025", // (example)
    accounts: [
      {
        id: 170,
        accountId: 26,
        accountName: "Revenue Account", // (looked up)
        months: {
          m1: 2000, m2: 2000, m3: 1000, m4: 2000, m5: 8000,
          m6: 100000, m7: 100, m8: 0, m9: 0, m10: 0, m11: 0, m12: 0
        },
        total: 115100
      }
    ]
  },
  {
    id: 5,
    name: "FY 2028/2029", // (example)
    accounts: [
      {
        id: 193,
        accountId: 26,
        accountName: "Revenue Account",
        months: {
          m1: 50000, m2: 0, m3: 0, m4: 0, m5: 0,
          m6: 0, m7: 0, m8: 0, m9: 0, m10: 0, m11: 0, m12: 0
        },
        total: 50000
      }
    ]
  }
]
            </div>

            <h3>Step 2: Financial Year Month Mapping</h3>
            <div class="data-block">
<span class="highlight">Key Insight:</span> Financial years start in March, so:

Database Columns â†’ Financial Year Order:
- m3 â†’ March (FY Start)
- m4 â†’ April
- m5 â†’ May
- m6 â†’ June
- m7 â†’ July
- m8 â†’ August
- m9 â†’ September
- m10 â†’ October
- m11 â†’ November
- m12 â†’ December
- m1 â†’ January
- m2 â†’ February (FY End)
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“ˆ Chart Data Generation</h2>

            <h3>Line Chart (Yearly Trends) - Current Approach âœ…</h3>
            <div class="data-block">
<span class="success">CORRECT:</span> Each year gets its own line showing monthly progression

Chart Data:
labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb']

datasets: [
  {
    label: "FY 2024/2025",
    data: [1000, 2000, 8000, 100000, 100, 0, 0, 0, 0, 0, 2000, 2000]
    //     Mar   Apr   May    Jun     Jul  Aug Sep Oct Nov Dec  Jan   Feb
  },
  {
    label: "FY 2028/2029",
    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50000, 0]
    //     Mar Apr May Jun Jul Aug Sep Oct Nov Dec Jan   Feb
  }
]
            </div>

            <h3>Bar Chart (Monthly Comparison) - New Approach ğŸ†•</h3>
            <div class="data-block">
<span class="info">NEW:</span> Group by month to compare same months across years

Chart Data:
labels: ['Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb']

datasets: [
  {
    label: "FY 2024/2025",
    data: [1000, 2000, 8000, 100000, 100, 0, 0, 0, 0, 0, 2000, 2000]
  },
  {
    label: "FY 2028/2029",
    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 50000, 0]
  }
]

<span class="highlight">Visual Result:</span>
- March: FY1=1000 vs FY5=0
- April: FY1=2000 vs FY5=0
- January: FY1=2000 vs FY5=50000 (FY5 is stronger in Jan!)
            </div>
        </div>

        <div class="section">
            <h2>ğŸ¯ Expected Comparison Results</h2>

            <table>
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>FY 2024/2025</th>
                        <th>FY 2028/2029</th>
                        <th>Better Performance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>March</td><td>R1,000</td><td>R0</td><td class="success">FY 2024/2025</td></tr>
                    <tr><td>April</td><td>R2,000</td><td>R0</td><td class="success">FY 2024/2025</td></tr>
                    <tr><td>May</td><td>R8,000</td><td>R0</td><td class="success">FY 2024/2025</td></tr>
                    <tr><td>June</td><td>R100,000</td><td>R0</td><td class="success">FY 2024/2025</td></tr>
                    <tr><td>July</td><td>R100</td><td>R0</td><td class="success">FY 2024/2025</td></tr>
                    <tr><td>August</td><td>R0</td><td>R0</td><td>Tie</td></tr>
                    <tr><td>September</td><td>R0</td><td>R0</td><td>Tie</td></tr>
                    <tr><td>October</td><td>R0</td><td>R0</td><td>Tie</td></tr>
                    <tr><td>November</td><td>R0</td><td>R0</td><td>Tie</td></tr>
                    <tr><td>December</td><td>R0</td><td>R0</td><td>Tie</td></tr>
                    <tr><td>January</td><td>R2,000</td><td>R50,000</td><td class="error">FY 2028/2029</td></tr>
                    <tr><td>February</td><td>R2,000</td><td>R0</td><td class="success">FY 2024/2025</td></tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>ğŸ” Debug Instructions</h2>
            <div class="data-block">
<span class="highlight">To verify the fix:</span>

1. Open browser console (F12)
2. Navigate to Financial â†’ Revenue Capture
3. Look for console messages:
   - "ğŸ“Š Updating financial comparison charts with data"
   - "ğŸ“Š Line Chart Data Generated"
   - "ğŸ“Š Monthly Comparison Bar Chart Data"

4. Check that:
   - Line chart shows year trends correctly
   - Bar chart allows month-by-month comparison
   - Toggle button switches between views

<span class="highlight">Expected Console Output:</span>
ğŸ“Š Line Chart Data Generated: {
  years: 2,
  monthLabels: ["Mar", "Apr", "May", ...],
  datasets: [
    { label: "FY 2024/2025 (Total: R115.1K)", dataPoints: 12, sampleData: [1000, 2000, 8000] },
    { label: "FY 2028/2029 (Total: R50.0K)", dataPoints: 12, sampleData: [0, 0, 0] }
  ]
}
            </div>
        </div>

        <div class="section chart-preview">
            <h2>ğŸ“Š Chart Preview</h2>
            <p><strong>Line Chart:</strong> Shows FY1 peaking in June (R100K), FY5 peaking in January (R50K)</p>
            <p><strong>Bar Chart:</strong> Side-by-side bars for each month, clearly showing which year performed better</p>
            <p><em>Use toggle button to switch between trend view and comparison view</em></p>
        </div>
    </div>
</body>
</html>
